CREATE VIEW V_MATRICULADOS
(IDSECCION, MATRICULADOS)
AS
SELECT S.IDSECCION, COUNT(M.IDSECCION) MATRICULADOS
FROM SECCION S 
LEFT JOIN MATRICULA M ON S.IDSECCION = M.IDSECCION
GROUP BY S.IDSECCION;
	


CREATE VIEW V_SECCION
( 
  IDSECCION, PERIODO, NIVEL, GRADO, INGRESO, MATRICULA, 
  NEWCUOTA, OLDCUOTA, PISO, AULA, CAPACIDAD, MATRICULADOS
)
AS
SELECT 
   S.IDSECCION, P.PERIODO, N.NOMBRE, G.NOMBRE, P.INGRESO,
   P.MATRICULA, P.CUOTA_NEW, P.CUOTA_OLD, A.PISO, 
   A.NOMBRE, A.CAPACIDAD, M.MATRICULADOS
FROM NIVEL   N
JOIN GRADO   G ON N.IDNIVEL = G.IDNIVEL
JOIN SECCION S ON G.IDNIVEL = S.IDNIVEL AND G.IDGRADO = S.IDGRADO
JOIN PERIODO P ON S.PERIODO = P.PERIODO
JOIN AULA    A ON S.IDAULA = A.IDAULA
JOIN V_MATRICULADOS M ON S.IDSECCION = M.IDSECCION;	


