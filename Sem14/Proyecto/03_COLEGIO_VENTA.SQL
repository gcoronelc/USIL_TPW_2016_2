/*
Empresa        :  EGCC
Software       :  Módulo de Ventas
DBMS           :  MySQL Server
Base de Datos  :  COLEGIO
Modulo         :  VENTAS
Script         :  Crea de Tablas.
Responsable    :  Ing. Eric Gustavo Coronel Castillo
Telefono       :  (511) 9966-64457
Email          :  gcoronelc@gmail.com
Sitio Web      :  http://www.desarrollasoftware.com
Blog           :  http://gcoronelc.blogspot.com
*/


-- ===========================
-- CREACION DE TABLAS
-- ===========================


CREATE TABLE TIPO_PAGO
(
	IDTIPO               INTEGER NOT NULL,
	NOMBRE               VARCHAR(50) NOT NULL,
	CONSTRAINT PK_TIPO_PAGO PRIMARY KEY (IDTIPO)
);



CREATE TABLE ESTUDIANTE
(
	IDEST                INTEGER AUTO_INCREMENT,
	APELLIDO             VARCHAR(60) NOT NULL,
	NOMBRE               VARCHAR(60) NOT NULL,
	DNI                  VARCHAR(20) NOT NULL,
	DIRECCION            VARCHAR(200) NOT NULL,
	CORREO               VARCHAR(100) NOT NULL,
	APONOMBRE            VARCHAR(100) NOT NULL,
	APOCORREO            VARCHAR(100) NOT NULL,
	APOTELEFONO          VARCHAR(20) NOT NULL,
	CONSTRAINT PK_ESTUDIANTE PRIMARY KEY (IDEST)
);



CREATE TABLE MATRICULA
(
	IDMAT                INTEGER AUTO_INCREMENT,
	IDEMP                INTEGER NOT NULL,
	IDEST                INTEGER NOT NULL,
	IDSECCION            INTEGER NOT NULL,
	FECHA                DATE NOT NULL,
	ESTADO               INTEGER NULL,
	CONSTRAINT PK_MATRICULA PRIMARY KEY (IDMAT),
	FOREIGN KEY FK_MATRICULA_SECCION (IDSECCION) REFERENCES SECCION (IDSECCION),
	FOREIGN KEY FK_MATRICULA_ESTUDIANTE (IDEST) REFERENCES ESTUDIANTE (IDEST),
	FOREIGN KEY FK_MATRICULA_USUARIO (IDEMP) REFERENCES USUARIO (IDEMP)
);



CREATE TABLE PAGO
(
	IDPAGO               INTEGER AUTO_INCREMENT,
	IDMAT                INTEGER NOT NULL,
	IDTIPO               INTEGER NOT NULL,
	EMPGENPAGO           INTEGER NOT NULL,
	EMPREGPAGO           INTEGER NULL,
	FECVENC              DATE NOT NULL,
	FECPAGO              DATE NULL,
	IMPORTE              NUMERIC(12,2) NOT NULL,
	MORA                 NUMERIC(12,2) NOT NULL,
	TOTAL                NUMERIC(10,2) NOT NULL,
	PENDIENTE            INTEGER NOT NULL,
	BOLSERIE             INTEGER NULL,
	BOLNRO               INTEGER NULL,
	CONSTRAINT PK_PAGO PRIMARY KEY (IDPAGO),
	FOREIGN KEY FK_PAGO_TIPO_PAGO (IDTIPO) REFERENCES TIPO_PAGO (IDTIPO),
	FOREIGN KEY FK_PAGO_MATRICULA (IDMAT) REFERENCES MATRICULA (IDMAT),
	FOREIGN KEY FK_PAGO_USUARIO_GEN (EMPGENPAGO) REFERENCES USUARIO (IDEMP),
	FOREIGN KEY FK_PAGO_USUARIO_REG (EMPREGPAGO) REFERENCES USUARIO (IDEMP)
);



CREATE UNIQUE INDEX U_PAGO ON PAGO
(
	IDMAT,
	IDTIPO
);

-- ===========================
-- CARGA DE DATOS
-- ===========================

INSERT INTO ESTUDIANTE VALUES
(1,'ALVARADO ANDRADE','BRENDA ALICIA','65782345','MIRAFLORES','BRENDA@GMAIL.COM','RENGIFO, CARLOS','CARLITOS@GMAIL.COM','784356872'),
(2,'TIRAJAYA MUÑOZ','CARLOS ENRIQUE','78345678','LOS OLIVOS','CARLOS@GMAIL.COM','CASTILLO, KARLA','KARLA@GMAIL.COM','978956435'),
(3,'AQUINO GALVAN','URSULA BRIGITHE','78546723','SMP','URSULA@GMAIL.COM','PIZARRO, EDISON','PIZARRO@GMAIL.COM','896578234'),
(4,'CAPUENA CARPIO','JULIO CESAR','45963514','LOS OLIVOS','JULIO@GMAIL.COM','ARBIETO, MARLENE','MARLENE@GMAIL.COM','986734567');





INSERT INTO TIPO_PAGO(IDTIPO,NOMBRE) VALUES
(1, 'CUOTA DE INGRESO'),
(2, 'CUOTA DE MATRICULA'),
(3, 'CUOTA DE MARZO'),
(4, 'CUOTA DE ABRIL'),
(5, 'CUOTA DE MAYO'),
(6, 'CUOTA DE JUNIO'),
(7, 'CUOTA DE JULIO'),
(8, 'CUOTA DE AGOSTO'),
(9, 'CUOTA DE SETIEMBRE'),
(10, 'CUOTA DE OCTUBRE'),
(11, 'CUOTA DE NOVIEMBRE'),
(12, 'CUOTA DE DICIEMBRE');

	
	